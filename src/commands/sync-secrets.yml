---

description: >
  Fetch secrets and mask them

parameters:
  secret_name:
    type: string
    description: "Secrets Manager secret name"
  circle_token:
    type: string
    description: "Environment Variable for CircleCI Token"
    default: $CIRCLE_TOKEN

steps:
  - run:
      environment:
        SECRET_NAME: <<parameters.secret_name>>
        CIRCLE_TOKEN: <<parameters.circle_token>>
      name: Fetch Secrets from GCP Secrets Manager
      command: curl -sS https://raw.githubusercontent.com/vjpandian/gcp-secret-sync/refs/heads/main/src/scripts/sync-secrets.sh | bash

