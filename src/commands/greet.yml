---

description: >
  Fetch secrets and mask them

parameters:
  secret_name:
    type: string
    description: "Secrets Manager secret name"
  circle_hostname:
    type: string
    default: "circleci.com"
  circle_token:
    type: env_var_name
    description: "Environment Variable for CircleCI Token"
    default: CIRCLE_TOKEN

steps:
  - run:
      environment:
        SECRET_NAME: <<parameters.secret_name>>
        CIRCLE_HOSTNAME: <<parameters.circle_hostname>>
        CIRCLE_TOKEN: <<parameters.circle_token>>
      name: Fetch Secrets from GCP Secrets Manager
      command: <<include(scripts/sync-secrets.sh)>>
